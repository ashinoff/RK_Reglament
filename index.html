<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–†–ï–ì–õ–ê–ú–ï–ù–¢ –†–ê–ë–û–¢–´ –ü–ê–û ¬´–†–û–°–°–ï–¢–ò –ö–£–ë–ê–ù–¨¬ª –ü–û –í–´–Ø–í–õ–ï–ù–ò–Æ, –°–û–ö–†–ê–©–ï–ù–ò–Æ –ò –ò–°–ö–õ–Æ–ß–ï–ù–ò–Æ –ë–ï–ó–î–û–ì–û–í–û–†–ù–û–ì–û –ò –ë–ï–ó–£–ß–ï–¢–ù–û–ì–û –ü–û–¢–†–ï–ë–õ–ï–ù–ò–Ø –≠–õ–ï–ö–¢–†–û–≠–ù–ï–†–ì–ò–ò</title>
  <meta name="description" content="–ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ –ì–ª–∞–≤–µ 4 –†–µ–≥–ª–∞–º–µ–Ω—Ç–∞: –∫—Ä–∞—Ç–∫–∏–µ –≤—ã–∂–∏–º–∫–∏ + —Ä–∞–∑–≤–æ—Ä–æ—Ç –ø–æ–ª–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –ø–æ –ø—É–Ω–∫—Ç—É." />
  <style>
    :root{
      --bg: #0b2a5b;      /* navy */
      --panel: #f2f5fb;   /* light panel */
      --muted: #475569;   /* slate-600 */
      --text: #0b0f17;    /* near-black */
      --accent: #1e40af;  /* blue-800 */
      --accent-2: #2563eb;/* blue-600 */
      --danger: #dc2626;  /* red-600 */
      --card: #ffffff;    /* white cards */
      --ring: rgba(37,99,235,.25);
      --mark: #fff59d;    /* highlight */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,Segoe UI,system-ui,-apple-system,Roboto,Arial,sans-serif;background:#ffffff;color:var(--text)}
    .container{max-width:1100px;margin:0 auto;padding:clamp(16px,2vw,32px)}
    header{position:sticky;top:0;background:var(--bg);color:#fff;backdrop-filter:blur(10px);z-index:10}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));box-shadow:0 10px 30px rgba(96,165,250,.35)}
    h1{font-size:clamp(18px,2.4vw,24px);margin:0}
    .sub{color:var(--muted);font-size:14px}

    .search{display:flex;gap:12px;align-items:center;margin:18px 0 10px}
    .search input{
      flex:1; background:var(--panel); border:1px solid transparent; color:var(--text);
      padding:14px 16px; border-radius:14px; font-size:16px; outline:none;
      transition:border .15s, box-shadow .15s;
    }
    .search input:focus{border-color:var(--accent); box-shadow:0 0 0 4px var(--ring)}
    .kbd{background:#0c1428;border:1px solid #1f2a44;border-bottom-width:2px;color:#aab4cf;padding:3px 8px;border-radius:8px;font-size:12px}

    .tips{display:flex;flex-wrap:wrap;gap:8px;margin:6px 0 18px}
    .tip{cursor:pointer;user-select:none;border:1px solid #1b2341;color:#c4cee6;background:#0a1227;padding:6px 10px;border-radius:999px;font-size:12px}
    .tip:hover{border-color:var(--accent);color:#e6fff6}

    .results-head{display:flex;align-items:center;justify-content:space-between;margin:8px 0 12px;color:var(--muted);font-size:14px}

    .list{display:grid;gap:12px}
    .card{background:var(--card);border:1px solid #e2e8f0;border-radius:16px;overflow:hidden}
    .card-h{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:12px 16px;cursor:pointer}
    .badge{background:#1d4ed8;color:#fff;border:0;padding:6px 10px;border-radius:999px;font-weight:700;font-size:12px}
    .title{font-weight:700}
    .summary{color:#1f2937}
    .meta{color:#475569;font-size:12px}

    .card-c{padding:8px 16px 16px 16px;display:none}
    .card.open .card-c{display:block}
    .btn-row{display:flex;gap:8px;align-items:center;margin:0 16px 14px}
    .btn{appearance:none;border:1px solid #e2e8f0;background:#eff6ff;color:#0b0f17;border-radius:12px;padding:10px 12px;font-size:14px;cursor:pointer}
    .btn:hover{border-color:var(--accent)}
    .btn.primary{background:#2563eb;border:1px solid #1d4ed8;color:#fff}

    details, details>summary{display:none}
    .fulltext{line-height:1.6;color:#0b0f17}.fulltext h3{margin:10px 0 6px}.fulltext p{margin:0 0 10px}
    .fulltext h3{margin:10px 0 6px}
    .fulltext p{margin:0 0 10px}

    .nores{padding:24px;text-align:center;color:#475569;border:1px dashed #e2e8f0;border-radius:16px}

    footer{margin:26px 0;color:var(--muted);font-size:12px}
    a{color:#1d4ed8}

    mark{background:var(--mark);padding:0 .15em;border-radius:.2em}

    .dock{position:fixed;bottom:16px;right:16px;display:flex;gap:8px;background:#ffffffee;border:1px solid #e2e8f0;padding:8px;border-radius:12px;box-shadow:0 6px 24px rgba(0,0,0,.12);backdrop-filter:saturate(140%) blur(6px)}
    .dock-btn{appearance:none;background:#f1f5f9;border:1px solid #cbd5e1;color:#0b0f17;border-radius:10px;padding:8px 10px;font-size:13px;cursor:pointer}
    .dock-btn:hover{border-color:#1d4ed8;color:#1d4ed8;background:#eff6ff}

    @media (min-width: 900px){
      .card-h{align-items:center}
      .title{font-size:16px}
    }
  .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .left{display:grid;gap:6px}
    .actions{display:flex;gap:6px;align-items:center}
    .icon{appearance:none;background:transparent;border:1px solid #cbd5e1;color:#0b0f17;border-radius:8px;padding:6px 8px;font-size:14px;line-height:1;cursor:pointer}
    .icon:hover{border-color:#1d4ed8;color:#1d4ed8}
    .chevron{user-select:none;transition:transform .15s ease}
    .card.open .chevron{transform:rotate(180deg)}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>–†–ï–ì–õ–ê–ú–ï–ù–¢ –†–ê–ë–û–¢–´ –ü–ê–û ¬´–†–û–°–°–ï–¢–ò –ö–£–ë–ê–ù–¨¬ª –ü–û –í–´–Ø–í–õ–ï–ù–ò–Æ, –°–û–ö–†–ê–©–ï–ù–ò–Æ –ò –ò–°–ö–õ–Æ–ß–ï–ù–ò–Æ –ë–ï–ó–î–û–ì–û–í–û–†–ù–û–ì–û –ò –ë–ï–ó–£–ß–ï–¢–ù–û–ì–û –ü–û–¢–†–ï–ë–õ–ï–ù–ò–Ø –≠–õ–ï–ö–¢–†–û–≠–ù–ï–†–ì–ò–ò</h1>
          <div class="sub">–ö—Ä–∞—Ç–∫–∞—è –≤—ã–∂–∏–º–∫–∞ ‚Üí —Ä–∞–∑–≤–æ—Ä–æ—Ç –ø–æ–ª–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –Ω—É–∂–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞</div>
        </div>
      </div>
      <div class="search" role="search">
        <input id="q" type="search" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¥–æ—Å—É–¥–µ–±–Ω–∞—è –ø—Ä–µ—Ç–µ–Ω–∑–∏—è, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, –∞–∫—Ç –Ω–µ–¥–æ–ø—É—Å–∫–∞‚Ä¶" aria-label="–ü–æ–∏—Å–∫ –ø–æ –ø—É–Ω–∫—Ç–∞–º –≥–ª–∞–≤—ã" autofocus />
        <span class="kbd" title="–ì–æ—Ä—è—á–∞—è –∫–ª–∞–≤–∏—à–∞">Ctrl /</span>
      </div>
      <div class="tips" id="tips"></div>
      <div class="results-head"><span id="count">–ù–∞–π–¥–µ–Ω–æ: 0</span><span>–ì–ª–∞–≤–∞ 4 ¬∑ –º–æ–±–∏–ª—å–Ω–∞—è/desktop-–≤–µ—Ä—Å–∏—è</span></div>
    </div>
  </header>

  <main class="container">
    <section id="list" class="list" aria-live="polite"></section>
    <div id="empty" class="nores" style="display:none">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ: <em>–±–µ–∑—É—á—ë—Ç</em>, <em>–±–µ–∑–¥–æ–≥–æ–≤–æ—Ä–Ω–æ–µ</em>, <em>–∞–∫—Ç</em>, <em>–∫–æ–º–∏—Å—Å–∏—è</em>, <em>–§–°–°–ü</em>.</div>

    <footer>
      <div>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç –ø–æ–ª–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ —Ñ–∞–π–ª–∞ <code>regulation.json</code> (—Å–º. –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ).</div>
      <div>–°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –∫ –ª–∞–∫–æ–Ω–∏—á–Ω—ã–º —à–ø–∞—Ä–≥–∞–ª–∫–∞–º ‚ù§</div>
    </footer>
    <div class="dock" aria-label="–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è">
      <button class="dock-btn" data-dock="open-all">–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å—ë</button>
      <button class="dock-btn" data-dock="close-all">–°–≤–µ—Ä–Ω—É—Ç—å –≤—Å—ë</button>
      <button class="dock-btn" data-dock="to-top">–ù–∞–≤–µ—Ä—Ö</button>
    </div>
  </main>

  <script>
  // ===========================
  // –î–ê–ù–ù–´–ï: –∫—Ä–∞—Ç–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ –ì–ª–∞–≤–µ 4
  // –ü–æ–ª–µ fullText –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º ‚Äî —Ç–æ–≥–¥–∞ –ø—Ä–∏ —Ä–∞—Å–∫—Ä—ã—Ç–∏–∏ —Ä–∞–∑–¥–µ–ª–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞
  // –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª regulation.json (–ª–µ–∂–∏—Ç —Ä—è–¥–æ–º –Ω–∞ GitHub Pages) –∏
  // –≤–∑—è—Ç—å –æ—Ç—Ç—É–¥–∞ HTML –ø–æ–ª–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –Ω—É–∂–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞.
  // –ü—Ä–∏–º–µ—Ä regulation.json:
  // {
  //   "4.15.2": {"html": "<h3>4.15.2. –í–∑—ã—Å–∫–∞–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –±–µ–∑–¥–æ–≥–æ–≤–æ—Ä–Ω–æ–≥–æ</h3><p>–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç‚Ä¶</p>"},
  //   "4.6.3": {"html": "<h3>4.6.3. –ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫</h3>‚Ä¶"}
  // }
  // ===========================

  const SECTIONS = [
    {
      id: "4.1",
      title: "–û–±—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è",
      summary: "–£—Ç–≤–µ—Ä–¥–∏—Ç—å —Ä–æ–ª–∏/–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π; –∑–∞–ø—É—Å–∫ –∫–∞–º–ø–∞–Ω–∏–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫; –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –†–µ–≥–ª–∞–º–µ–Ω—Ç–∞ –∫–æ –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –ø—Ä–æ—Ü–µ—Å—Å–∞.",
      keywords: ["–æ–±—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è","–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å","—Ä–æ–ª–∏","—Å—Ç–∞—Ä—Ç –∫–∞–º–ø–∞–Ω–∏–∏","–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω"],
      fullText: ""
    },
    {
      id: "4.2",
      title: "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è",
      summary: "–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ —Ö–∏—â–µ–Ω–∏–π: –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, —Å—Ç–µ–Ω–¥—ã, –≤–∏–¥–µ–æ, FAQ –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏; —Ü–µ–ª—å ‚Äî —É—Å–∫–æ—Ä–∏—Ç—å –∑–∞–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –∏ —Å–Ω–∏–∑–∏—Ç—å –ë–£/–ë–î.",
      keywords: ["–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ","–ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞","–ª–∏—Å—Ç–æ–≤–∫–∏","–°–ú–ò","–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å","7.19 –ö–æ–ê–ü"],
      fullText: ""
    },
    {
      id: "4.3",
      title: "–î–æ–≥–æ–≤–æ—Ä –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –Ω–æ–≤—ã–º –¢–ü",
      summary: "–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞ —Å –≠–°–ö/–ì–ü –Ω–∞ —ç—Ç–∞–ø–µ –¢–ü; —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ –∞–∫—Ç–∞ –¢–ü –≤ –õ–ö; —Å—Ä–æ–∫–∏ –ø–µ—Ä–µ—Å—ã–ª–æ–∫ ‚Äî –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 2 –†–î.",
      keywords: ["–¥–æ–≥–æ–≤–æ—Ä","–¢–ü","–ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç","–≠–°–ö","–ì–ü","2 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è"],
      fullText: ""
    },
    {
      id: "4.4",
      title: "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–∞",
      summary: "–ö–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ë–î –∏ —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –æ–Ω–æ –Ω–µ –ø—Ä–∏–∑–Ω–∞—ë—Ç—Å—è (–ø–µ—Ä–µ—Ö–æ–¥–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã, —Å–º–µ–Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞, 2 –º–µ—Å—è—Ü–∞ –ø–æ—Å–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –ì–ü).",
      keywords: ["–±–µ–∑–¥–æ–≥–æ–≤–æ—Ä–Ω–æ–µ","–∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è","—Å–º–µ–Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞","2 –º–µ—Å—è—Ü–∞","–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ì–ü"],
      fullText: ""
    },
    {
      id: "4.5",
      title: "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å",
      summary: "–í–≤–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–≤–ª–µ–Ω–∏—è –í–õ 10/0,4 –∫–í), –∞–∫—Ç + —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ; —Å–∞–º–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è = –ë–£/–ë–î.",
      keywords: ["–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ","–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ","—Ñ–æ—Ç–æ","–≤–∏–¥–µ–æ","—Å–∞–º–æ–≤–æ–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ"],
      fullText: ""
    },
    {
      id: "4.6",
      title: "–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø–æ –±–µ–∑—É—á—ë—Ç–Ω–æ–º—É",
      summary: "–ü–ª–∞–Ω-–≥—Ä–∞—Ñ–∏–∫ —Ä–µ–π–¥–æ–≤ –ø–æ –æ—á–∞–≥–∞–º –ø–æ—Ç–µ—Ä—å; –≥—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–∞ (–Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏, —Ä–µ—Ü–∏–¥–∏–≤—ã, –Ω–µ–¥–æ–ø—É—Å–∫–∏, –ø–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º); –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å –û–ú–°–£/–û–í–î/–°–ú–ò.",
      keywords: ["–ø–ª–∞–Ω-–≥—Ä–∞—Ñ–∏–∫","—Ä–µ–π–¥—ã","–æ—á–∞–≥–∏ –ø–æ—Ç–µ—Ä—å","–≥—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–∞"],
      fullText: ""
    },
    {
      id: "4.6.1",
      title: "–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–∫—Ç—Ä–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è",
      summary: "–û—Ç–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Ä–µ–π–¥—ã –ø–æ –ø—Ä–æ—Ñ–∏–ª—è–º/–±–∞–ª–∞–Ω—Å–∞–º –ê–°–ö–£–≠/–ò–°–£; —Å–≤–µ—Ä–∫–∞ —Å —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç—å—é; —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤.",
      keywords: ["–∞–Ω–∞–ª–∏–∑","–ê–°–ö–£–≠","–ø—Ä–æ—Ñ–∏–ª–∏","–±–∞–ª–∞–Ω—Å—ã","–æ—Ç–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤"],
      fullText: ""
    },
    {
      id: "4.6.2",
      title: "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ",
      summary: "–ü—Ä–∞–≤–æ–æ–±–ª–∞–¥–∞—Ç–µ–ª—å –ø–æ –ï–ì–†–ù, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–æ–≤–µ—Ä–∫–µ/–≤—Å–∫—Ä—ã—Ç–∏–∏ –ø–ª–æ–º–± —Å –ø—Ä–∞–≤–∞–º–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è/—Ñ–æ—Ç–æ-–≤–∏–¥–µ–æ; –æ–ø–µ—á–∞—Ç—ã–≤–∞–Ω–∏–µ/—É–ø–∞–∫–æ–≤–∫–∞ –ü–£ –ø—Ä–∏ –∏–∑—ä—è—Ç–∏–∏.",
      keywords: ["—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ","–ï–ì–†–ù","–≤—Å–∫—Ä—ã—Ç–∏–µ –ø–ª–æ–º–±","–∏–∑—ä—è—Ç–∏–µ –ü–£","–æ–ø–µ—á–∞—Ç—ã–≤–∞–Ω–∏–µ"],
      fullText: ""
    },
    {
      id: "4.6.3",
      title: "–ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ",
      summary: "–ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å—Å—è, —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ, —Ü–µ–ª—å/–æ—Å–Ω–æ–≤–∞–Ω–∏–µ; –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ—Ñ–∏–∫—Å–∞—Ü–∏—è (–¥–∞—Ç–∞/–≤—Ä–µ–º—è/–ø—Ä–∏–≤—è–∑–∫–∞), –∞–∫—Ç; –ø—Ä–∏ –Ω–µ–¥–æ–ø—É—Å–∫–µ ‚Äî –∞–∫—Ç –Ω–µ–¥–æ–ø—É—Å–∫–∞ —Å 2 —Å–≤–∏–¥–µ—Ç–µ–ª—è–º–∏.",
      keywords: ["–ø—Ä–æ–≤–µ—Ä–∫–∞","–∞–∫—Ç","–Ω–µ–¥–æ–ø—É—Å–∫","—Ñ–æ—Ç–æ","–≤–∏–¥–µ–æ","—Å–≤–∏–¥–µ—Ç–µ–ª–∏"],
      fullText: ""
    },
    {
      id: "4.7",
      title: "–£—á—ë—Ç –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–ª–∞–Ω–∫–æ–≤/–∞–∫—Ç–æ–≤",
      summary: "–ñ—É—Ä–Ω–∞–ª—ã –≤—ã–¥–∞—á–∏/–¥–≤–∏–∂–µ–Ω–∏—è (–ø—Ä–æ–Ω—É–º., –ø—Ä–æ—à–Ω—É—Ä., –æ–ø–µ—á–∞—Ç.), —Ä–µ–µ—Å—Ç—Ä –∫–æ–º–ø–ª–µ–∫—Ç–æ–≤; —Å–∫–∞–Ω—ã –∞–∫—Ç–æ–≤ —Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–º–µ—Å—è—á–Ω–æ 5 –ª–µ—Ç –∏–ª–∏ –¥–æ –ø–æ–ª–Ω–æ–π –æ–ø–ª–∞—Ç—ã.",
      keywords: ["–∂—É—Ä–Ω–∞–ª—ã","—É—á—ë—Ç","—Ö—Ä–∞–Ω–µ–Ω–∏–µ","—Å–∫–∞–Ω—ã","5 –ª–µ—Ç"],
      fullText: ""
    },
    {
      id: "4.8",
      title: "–¢–∏–ø–æ–≤—ã–µ —Å–ø–æ—Å–æ–±—ã –Ω–µ—É—á—Ç—ë–Ω–Ω–æ–≥–æ",
      summary: "–ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: —Å–∞–º–æ–≤–æ–ª—å–Ω—ã–µ –≤–≤–æ–¥—ã/–æ–±—Ö–æ–¥ –ü–£/–ø–µ—Ä–µ–º—ã—á–∫–∏, –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ/–º–∞–≥–Ω–∏—Ç—ã, –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–∞—Å—á—ë—Ç–Ω–æ–≥–æ –ü–£ –∏ –ø—Ä.",
      keywords: ["–±–µ–∑—É—á—ë—Ç","–ø—Ä–∏–∑–Ω–∞–∫–∏","–º–∞–≥–Ω–∏—Ç","–ø–µ—Ä–µ–º—ã—á–∫–∞","–ø–ª–æ–º–±—ã"],
      fullText: ""
    },
    {
      id: "4.9",
      title: "–û–±–æ—Ä–æ—Ç —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∞–∫—Ç–æ–≤",
      summary: "–ü–µ—Ä–µ–¥–∞—á–∞ –∞–∫—Ç–æ–≤ –≤ –£–†–†–£/–§–≠–° —Å —Ä–∞—Å—á—ë—Ç–æ–º –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ –≤ 2 –†–î (–¥–ª—è –ë–î –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ); –≤–µ–¥–µ–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–æ–≤/–∂—É—Ä–Ω–∞–ª–æ–≤ –ø–æ —Ñ–æ—Ä–º–∞–º.",
      keywords: ["–æ–±–æ—Ä–æ—Ç –∞–∫—Ç–æ–≤","2 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è","—Ä–µ–µ—Å—Ç—Ä—ã","–∂—É—Ä–Ω–∞–ª—ã"],
      fullText: ""
    },
    {
      id: "4.10",
      title: "–†–∞—Å—á—ë—Ç –æ–±—ä—ë–º–∞ –±–µ–∑—É—á—ë—Ç–Ω–æ–≥–æ (—é—Ä–ª–∏—Ü–∞)",
      summary: "–ü–æ –ü–ü 442 (–ø.187): –ø–µ—Ä–∏–æ–¥ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π/–¥–æ–ª–∂–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ –¥–∞—Ç—ã –∞–∫—Ç–∞, ‚â§ 4380 —á, —Å—á–∏—Ç–∞—Ç—å 24 —á/—Å—É—Ç–∫–∏; –≠–°–ö –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç –∏ –≤–∑—ã—Å–∫–∏–≤–∞–µ—Ç.",
      keywords: ["—Ä–∞—Å—á—ë—Ç","—é—Ä–ª–∏—Ü–∞","4380 —á–∞—Å–æ–≤","–ü–ü 442"],
      fullText: ""
    },
    {
      id: "4.11",
      title: "–†–∞—Å—á—ë—Ç –±–µ–∑—É—á—ë—Ç–Ω–æ–≥–æ (–Ω–∞—Å–µ–ª–µ–Ω–∏–µ)",
      summary: "–ü–æ –ø–æ–∫–∞–∑–∞–Ω–∏—è–º –∑–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –ø—Ä–æ—à–ª–æ–≥–æ –≥–æ–¥–∞ —Å –∫–æ—ç—Ñ. 10 (–ª–∏–±–æ –±–ª–∏–∂–∞–π—à–∏–π –ø–µ—Ä–∏–æ–¥); ‚â§ 8760 —á; –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–∞ –∏ —Ä–µ—à–µ–Ω–∏—è –∫–æ–º–∏—Å—Å–∏–∏.",
      keywords: ["–Ω–∞—Å–µ–ª–µ–Ω–∏–µ","–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç 10","8760 —á–∞—Å–æ–≤","–ü–ü 354"],
      fullText: ""
    },
    {
      id: "4.12",
      title: "–†–∞—Å—á—ë—Ç –±–µ–∑–¥–æ–≥–æ–≤–æ—Ä–Ω–æ–≥–æ",
      summary: "–ó–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–∏–æ–¥ (‚â§ 8760 —á); –ø—Ä–∏ —Å–∞–º–æ–≤–æ–ª—å–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è—Ö ‚Äî –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏; –º–æ—â–Ω–æ—Å—Ç—å –ø–æ –ø–∞—Å–ø–æ—Ä—Ç—É/–¥–æ–ø—É—Å—Ç–∏–º—ã–º —Ç–æ–∫–∞–º.",
      keywords: ["–±–µ–∑–¥–æ–≥–æ–≤–æ—Ä–Ω–æ–µ","—Å–∞–º–æ–≤–æ–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ","–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Ç–æ–∫–∏","—Å–µ—á–µ–Ω–∏—è"],
      fullText: ""
    },
    {
      id: "4.13",
      title: "–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ/–Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å –ü–£, –ø–æ–≤–µ—Ä–∫–∞",
      summary: "–ü–µ—Ä–µ—Ä–∞—Å—á—ë—Ç –ø–æ –∑–∞–º–µ—â–∞—é—â–µ–π –∏–Ω—Ñ.: –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –ø—Ä–æ—à–ª–æ–≥–æ –≥–æ–¥–∞ (–∏–ª–∏ –±–ª–∏–∂–∞–π—à–∏–π); –≤ –ò–°–£/–ê–°–ö–£–≠ ‚Äî –∑–∞ 3 —Ä–∞—Å—á. –ø–µ—Ä–∏–æ–¥–∞; –∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ ‚Äî –ø–æ –ü–ü 354.",
      keywords: ["–ø–æ–≤–µ—Ä–∫–∞","–Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å","–∑–∞–º–µ—â–∞—é—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è","–ò–°–£","–ê–°–ö–£–≠"],
      fullText: ""
    },
    {
      id: "4.14",
      title: "–ö–æ–º–∏—Å—Å–∏–æ–Ω–Ω–æ–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –∞–∫—Ç–æ–≤",
      summary: "–ö–æ–º–∏—Å—Å–∏–∏ –£–†–†–£/–§–≠–° ‚â• 3 —á–µ–ª.; –ø—Ä–æ—Ç–æ–∫–æ–ª —Ä–µ—à–µ–Ω–∏–π; —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∫–∞–Ω–æ–≤ –≤–º–µ—Å—Ç–µ —Å –∞–∫—Ç–∞–º–∏; –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è: —É—Ç–≤./–¥–æ—Ä–∞–±–æ—Ç–∫–∞/–≤ –§–≠–°/–≤ –≠–°–ö/–≤ –°–ü–°–î–§/–Ω–∞ —Å–ø–∏—Å–∞–Ω–∏–µ.",
      keywords: ["–∫–æ–º–∏—Å—Å–∏—è","–ø—Ä–æ—Ç–æ–∫–æ–ª","–£–†–†–£","–§–≠–°","–°–ü–°–î–§"],
      fullText: ""
    },
    {
      id: "4.15.1",
      title: "–í–æ–∑–º–µ—â–µ–Ω–∏–µ —É—â–µ—Ä–±–∞: –†–°–ö ‚Üî –≠–°–ö (–±–µ–∑—É—á—ë—Ç)",
      summary: "–û–±–º–µ–Ω –∞–∫—Ç–∞–º–∏ –∏ —Ä–∞—Å—á—ë—Ç–∞–º–∏ –≤ 3 –†–î; –≠–°–ö –≤–µ–¥—ë—Ç –ø—Ä–µ—Ç–µ–Ω–∑–∏–æ–Ω–Ω–æ-–∏—Å–∫–æ–≤—É—é –ø–æ –ë–£; –ø–∞–∫–µ—Ç: —Ä–∞—Å—á—ë—Ç, –º–µ–¥–∏–∞, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—é.",
      keywords: ["–≤–æ–∑–º–µ—â–µ–Ω–∏–µ","–ø—Ä–µ—Ç–µ–Ω–∑–∏–æ–Ω–Ω–∞—è","–≠–°–ö","3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è","–±–µ–∑—É—á—ë—Ç"],
      fullText: ""
    },
    {
      id: "4.15.2",
      title: "–í–∑—ã—Å–∫–∞–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –±–µ–∑–¥–æ–≥–æ–≤–æ—Ä–Ω–æ–≥–æ",
      summary: "–î–æ—Å—É–¥–µ–±–Ω–∞—è –ø—Ä–µ—Ç–µ–Ω–∑–∏—è, —Å–±–æ—Ä –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤; –ø–æ–¥–∞—á–∞ –≤ —Å—É–¥ ‚â§ 3 –º–µ—Å.; –§–°–°–ü: –æ—Ç–ø—Ä–∞–≤–∫–∞ –ò–õ ‚â§ 10 –†–î (‚â§ 1 –º–µ—Å. –ø–æ—Å–ª–µ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ —Å–∏–ª—É); –ø—Ä–∏ –Ω–µ–≤–∑—ã—Å–∫–∏–≤–∞–µ–º–æ—Å—Ç–∏ ‚Äî –ø–∞–∫–µ—Ç –Ω–∞ —Å–ø–∏—Å–∞–Ω–∏–µ (–§–≠–° ‚â§ 1 –º–µ—Å.).",
      keywords: ["–¥–æ—Å—É–¥–µ–±–Ω–∞—è –ø—Ä–µ—Ç–µ–Ω–∑–∏—è","–§–°–°–ü","–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ª–∏—Å—Ç","—Å—É–¥","—Å–ø–∏—Å–∞–Ω–∏–µ"],
      fullText: ""
    },
    {
      id: "4.15.3",
      title: "–ó–∞—è–≤–ª–µ–Ω–∏—è –≤ –ø—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ä–≥–∞–Ω—ã",
      summary: "–ù–∞–ø—Ä–∞–≤–ª—è—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø—Ä–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö —Å–æ—Å—Ç–∞–≤–∞; —Ñ–æ—Ä–º—ã –ü—Ä–∏–ª. 13‚Äì15 (–ø–æ—Ä–æ–≥ —Å—É–º–º—ã/–Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è); –ø—Ä–∏ –æ—Ç–∫–∞–∑–∞—Ö ‚Äî –∞–Ω–∞–ª–∏–∑ –∏ –æ–±–∂–∞–ª–æ–≤–∞–Ω–∏–µ.",
      keywords: ["–û–í–î","–†–¢–ù","–∑–∞—è–≤–ª–µ–Ω–∏–µ","–ö–£–°–ü","–æ–±–∂–∞–ª–æ–≤–∞–Ω–∏–µ"],
      fullText: ""
    },
    {
      id: "4.15.4",
      title: "–û–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∏ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å",
      summary: "–ö–∞–∂–¥—ã–π –∞–∫—Ç –≤ 1–°:–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞; –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (—Ñ–æ—Ä–º—ã 8.1‚Äì8.2) –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 1 –†–î; –æ—Ç—á—ë—Ç –¥–æ 18-–≥–æ —á–∏—Å–ª–∞; —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∫–∞–Ω–æ–≤/–∂—É—Ä–Ω–∞–ª–æ–≤ 5 –ª–µ—Ç.",
      keywords: ["1–°","—Å–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞","8.1","8.2","18 —á–∏—Å–ª–æ","5 –ª–µ—Ç"],
      fullText: ""
    }
  ];

  const SUGGESTS = [
    "–¥–æ—Å—É–¥–µ–±–Ω–∞—è –ø—Ä–µ—Ç–µ–Ω–∑–∏—è",
    "–∞–∫—Ç –Ω–µ–¥–æ–ø—É—Å–∫–∞",
    "–∫–æ–º–∏—Å—Å–∏—è –£–†–†–£",
    "—Å–∞–º–æ–≤–æ–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ",
    "–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 0,4 –∫–í",
    "–§–°–°–ü –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ª–∏—Å—Ç",
    "–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç 10",
    "4380 —á–∞—Å–æ–≤",
  ];

  // ===== —É—Ç–∏–ª–∏—Ç—ã
  const $ = (sel, el=document) => el.querySelector(sel);
  const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));
  const norm = s => (s||"").toString().toLowerCase().replaceAll("—ë","–µ").trim();
  const debounce = (fn,ms=200)=>{let t;return (...a)=>{clearTimeout(t);t=setTimeout(()=>fn(...a),ms)}};

  // ===== —Ä–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞
  const listEl = $('#list');
  const emptyEl = $('#empty');
  const countEl = $('#count');
  const input = $('#q');

  function score(section, q){
    if(!q) return 1;
    const hay = norm([section.id, section.title, section.summary, (section.keywords||[]).join(' ')].join(' '));
    const qs = norm(q).split(/\s+/).filter(Boolean);
    let sc = 0;
    for(const term of qs){ if(hay.includes(term)) sc += 1; }
    // –Ω–µ–±–æ–ª—å—à–æ–µ –±—É—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è id
    if(norm(section.id)===norm(q)) sc+=2;
    return sc;
  }

  function render(q=""){
    const scored = SECTIONS.map(s=>({s, sc: score(s,q)})).filter(x=>x.sc>0 || !q);
    scored.sort((a,b)=> b.sc - a.sc || a.s.id.localeCompare(b.s.id, 'ru'));

    listEl.innerHTML = '';
    if(scored.length===0){ emptyEl.style.display='block'; countEl.textContent = '–ù–∞–π–¥–µ–Ω–æ: 0'; return; }
    emptyEl.style.display='none';
    countEl.textContent = `–ù–∞–π–¥–µ–Ω–æ: ${scored.length}`;

    for(const {s} of scored){
      const card = document.createElement('article');
      card.className = 'card';
      card.setAttribute('data-id', s.id);
      card.innerHTML = `
        <div class="card-h" data-action="toggle">
          <div class="left">
            <div class="row">
              <span class="badge" title="–ù–æ–º–µ—Ä –ø—É–Ω–∫—Ç–∞">¬ß ${s.id}</span>
              <span class="title">${escapeHTML(s.title)}</span>
            </div>
            <div class="summary">${highlight(s.summary, q)}</div>
            <div class="meta">–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: ${(s.keywords||[]).slice(0,6).join(', ')}</div>
          </div>
          <div class="actions">
            <button class="icon" data-action="copy-link" title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –ø—É–Ω–∫—Ç">üîó</button>
            <span class="icon chevron" aria-hidden="true">‚ñæ</span>
          </div>
        </div>
        <div class="card-c">
          <div class="fulltext" id="full-${s.id}"><em>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—É–Ω–∫—Ç, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç‚Ä¶</em></div>
        </div>`;

      card.addEventListener('click', async (e)=>{
        const linkBtn = e.target.closest('button[data-action="copy-link"]');
        if(linkBtn){
          e.stopPropagation();
          const url = new URL(location.href);
          url.hash = s.id;
          navigator.clipboard.writeText(url.toString()).then(()=>{
            linkBtn.textContent = '‚úì';
            setTimeout(()=>linkBtn.textContent='üîó',1200);
          });
          return;
        }
        if(e.target.closest('.card-h')){
          card.classList.toggle('open');
          if(card.classList.contains('open')){ await ensureFullTextLoaded(s.id); }
        }
      });

      listEl.appendChild(card);
    }

    // –∞–≤—Ç–æ-—Ä–∞—Å–∫—Ä—ã—Ç–∏–µ –ø–æ hash
    const hash = location.hash.replace('#','');
    if(hash){
      const target = $(`.card[data-id="${CSS.escape(hash)}"]`);
      if(target){
        target.classList.add('open');
        ensureFullTextLoaded(hash);
        target.scrollIntoView({behavior:'smooth', block:'start'});
      }
    }
  }

  // ===== –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ —Ç–µ—Ä–º–∞ –≤ summary
  function highlight(text, q){
    if(!q) return escapeHTML(text);
    const terms = norm(q).split(/\s+/).filter(Boolean).map(t=>t.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'));
    if(!terms.length) return escapeHTML(text);
    const re = new RegExp('('+terms.join('|')+')','gi');
    return escapeHTML(text).replace(re, '<mark>$1</mark>');
  }

  function escapeHTML(s){
    return (s||'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');
  }

  // ===== –∑–∞–≥—Ä—É–∑–∫–∞ regulation.json –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
  let FULL_MAP = null; // { id: {html:"‚Ä¶"} }
  async function loadFullMap(){
    if(FULL_MAP!==null) return FULL_MAP;
    try{
      const res = await fetch('regulation.json', {cache:'no-store'});
      if(!res.ok) throw new Error('HTTP '+res.status);
      const data = await res.json();
      FULL_MAP = data || {};
    }catch(e){
      FULL_MAP = {}; // –±–µ–∑ —Ñ–∞–π–ª–∞ —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö fullText (–µ—Å–ª–∏ –µ—Å—Ç—å)
    }
    return FULL_MAP;
  }

  async function ensureFullTextLoaded(id){
    const host = SECTIONS.find(x=>x.id===id);
    const slot = document.getElementById(`full-${id}`);
    if(!slot) return;

    // –µ—Å–ª–∏ —É–∂–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è–ª–∏ ‚Äî –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º
    if(slot.getAttribute('data-loaded')==='1') return;

    // 1) –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π fullText
    if(host && host.fullText){
      slot.innerHTML = host.fullText;
      slot.setAttribute('data-loaded','1');
      return;
    }
    // 2) –ø—Ä–æ–±—É–µ–º –∏–∑ regulation.json
    const map = await loadFullMap();
    const rec = map[id];
    if(rec && rec.html){
      slot.innerHTML = rec.html;
      slot.setAttribute('data-loaded','1');
      return;
    }
    // 3) —Ä–µ–∑–µ—Ä–≤–Ω—ã–π —Ç–µ–∫—Å—Ç
    slot.innerHTML = `<p style="color:#9fb0cc">–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è ¬ß ${id} –ø–æ–∫–∞ –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω. –î–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª <code>regulation.json</code> –≤ –∫–æ—Ä–µ–Ω—å —Å–∞–π—Ç–∞ (GitHub Pages) –ø–æ –æ–±—Ä–∞–∑—Ü—É –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –∫ –∫–æ–¥—É.</p>`;
    slot.setAttribute('data-loaded','1');
  }

  // ===== –ø–æ–¥—Å–∫–∞–∑–∫–∏
  const tips = $('#tips');
  tips.innerHTML = SUGGESTS.map(t=>`<button class="tip" data-v="${t}">${t}</button>`).join('');
  tips.addEventListener('click', (e)=>{
    const btn = e.target.closest('.tip'); if(!btn) return;
    input.value = btn.getAttribute('data-v'); doSearch(); input.focus();
  });

  // ===== –ø–æ–∏—Å–∫
  const doSearch = debounce(()=>{ render(input.value); persistQuery(); }, 150);
  input.addEventListener('input', doSearch);

  // –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–¥–æ–∫-–±–∞—Ä)
  function getCards(){ return Array.from(document.querySelectorAll('.card')); }
  async function openAll(){
    const list = getCards();
    for(const c of list){
      c.classList.add('open');
      const id = c.getAttribute('data-id');
      if(id) await ensureFullTextLoaded(id);
    }
  }
  function closeAll(){
    const list = getCards();
    for(const c of list){ c.classList.remove('open'); }
  }
  document.addEventListener('click', async (e)=>{
    const b = e.target.closest('.dock-btn'); if(!b) return;
    const act = b.getAttribute('data-dock');
    if(act==='open-all'){ await openAll(); }
    if(act==='close-all'){ closeAll(); }
    if(act==='to-top'){ window.scrollTo({top:0,behavior:'smooth'}); }
  });

  // –≥–æ—Ä—è—á–∞—è –∫–ª–∞–≤–∏—à–∞ Ctrl+/
  window.addEventListener('keydown',(e)=>{
    if((e.ctrlKey||e.metaKey) && e.key === '/'){
      e.preventDefault(); input.focus(); input.select();
    }
  });

  // –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–ø—Ä–æ—Å –∏–∑ URL
  function readQuery(){
    const url = new URL(location.href);
    const q = url.searchParams.get('q') || '';
    if(q){ input.value = q; }
  }
  function persistQuery(){
    const url = new URL(location.href);
    if(input.value){ url.searchParams.set('q', input.value); }
    else { url.searchParams.delete('q'); }
    history.replaceState(null,'',url);
  }

  readQuery();
  render(input.value);

  </script>
</body>
</html>
